# HBuilderXæ‰©å±•è·¨å¹³å°æ‰“åŒ…æŒ‡å—

## æ¦‚è¿°

æœ¬ç›®å½•åŒ…å«äº†ç”¨äºæ„å»ºå’Œæ‰“åŒ…HBuilderXæ‰©å±•çš„å®Œæ•´è„šæœ¬ç³»ç»Ÿï¼Œç‰¹åˆ«é’ˆå¯¹è§£å†³åŸç”Ÿä¾èµ–ï¼ˆå¦‚sqlite3ï¼‰çš„è·¨å¹³å°å…¼å®¹æ€§é—®é¢˜ã€‚æ•´ä¸ªæ„å»ºç³»ç»Ÿé‡‡ç”¨ä¸‰é˜¶æ®µæµç¨‹ï¼š**ä¾èµ–å‡†å¤‡ â†’ ç¼–æ’æ§åˆ¶ â†’ å®é™…æ‰“åŒ…**ã€‚

## è„šæœ¬æ¶æ„

### æ„å»ºæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    package-all-platforms.js                â”‚
â”‚                     (ä¸»æ§åˆ¶å™¨/ç¼–æ’è„šæœ¬)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¯¹æ¯ä¸ªç›®æ ‡å¹³å° (darwin-arm64, win32-x64, ç­‰)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ 1. ä¾èµ–å‡†å¤‡  â”‚â†’ â”‚ 2. ä¾èµ–éªŒè¯  â”‚â†’ â”‚ 3. å®é™…æ‰“åŒ…  â”‚          â”‚
â”‚  â”‚(prepackage) â”‚  â”‚(validate)   â”‚  â”‚(package.js) â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä¸»è¦è„šæœ¬è¯¦è§£

### 1. `package-all-platforms.js` - ä¸»æ§åˆ¶å™¨/ç¼–æ’è„šæœ¬

**ğŸ¯ ä¸»è¦ä½œç”¨**: é«˜çº§ç¼–æ’è„šæœ¬ï¼Œç®¡ç†å¤šå¹³å°æ‰“åŒ…çš„å®Œæ•´æµç¨‹

**æ ¸å¿ƒåŠŸèƒ½:**

- ğŸ”„ **å·¥ä½œæµç¨‹ç®¡ç†**: ä¸ºæ¯ä¸ªç›®æ ‡å¹³å°ä¾æ¬¡æ‰§è¡Œï¼šä¾èµ–å‡†å¤‡ â†’ éªŒè¯ â†’ æ‰“åŒ… â†’ æ¸…ç†
- ğŸ“Š **æŠ¥å‘Šç”Ÿæˆ**: ç”Ÿæˆè¯¦ç»†çš„æ‰“åŒ…æŠ¥å‘Šå’Œç»Ÿè®¡ä¿¡æ¯
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- ğŸ§¹ **è‡ªåŠ¨æ¸…ç†**: æ¯ä¸ªå¹³å°æ‰“åŒ…å®Œæˆåè‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶
- ğŸ¯ **å¹³å°ç®¡ç†**: æ”¯æŒå•å¹³å°æˆ–å…¨å¹³å°æ‰“åŒ…

**ä¾èµ–å…³ç³»:**

- è°ƒç”¨ `npm run prepare-deps` (å³ `prepackage-cross-platform.js`)
- è°ƒç”¨ `npm run package` (å³ `package.js`)
- ä½¿ç”¨å†…ç½®çš„ `validateNativeDependencies()` å‡½æ•°

**æ”¯æŒçš„å¹³å°:**

- `darwin-arm64` (macOS ARM64)
- `darwin-x64` (macOS x64)
- `win32-arm64` (Windows ARM64)
- `win32-x64` (Windows x64)

### 2. `prepackage-cross-platform.js` - ä¾èµ–å‡†å¤‡è„šæœ¬

**ğŸ—ï¸ ä¸»è¦ä½œç”¨**: ä¸ºç‰¹å®šç›®æ ‡å¹³å°å‡†å¤‡æ‰€æœ‰å¿…éœ€çš„ä¾èµ–é¡¹å’Œèµ„æº

**æ ¸å¿ƒåŠŸèƒ½:**

- ğŸ§¹ **ç¯å¢ƒæ¸…ç†**: æ¸…ç†ä¸´æ—¶ç›®å½• (`bin`, `out`)
- ğŸ“‹ **é…ç½®å¤åˆ¶**: å¤åˆ¶é…ç½®æ–‡ä»¶åˆ°å…¶ä»–æ‰©å±•
- ğŸ“¦ **æ¨¡å—å®‰è£…**: å®‰è£…Node.jsæ¨¡å—
- ğŸ¨ **GUIæ„å»º**: æ„å»ºç”¨æˆ·ç•Œé¢å¹¶å¤åˆ¶åˆ°æ‰©å±•ç›®å½•
- ğŸ“ **èµ„æºå¤åˆ¶**: å¤åˆ¶æ”¯æŒèµ„æºã€Tree-sitteræ–‡ä»¶ã€æ¨¡å‹ç­‰
- â¬‡ï¸ **åŸç”Ÿä¾èµ–ä¸‹è½½**: ä¸‹è½½å¹³å°ç‰¹å®šçš„åŸç”ŸäºŒè¿›åˆ¶æ–‡ä»¶
- âœ… **å®Œæ•´æ€§éªŒè¯**: éªŒè¯æ‰€æœ‰å¿…éœ€æ–‡ä»¶æ˜¯å¦æ­£ç¡®å®‰è£…

**å¤„ç†çš„åŸç”Ÿä¾èµ–:**

- **SQLite3**: æ•°æ®åº“å­˜å‚¨å’Œç´¢å¼•
- **ONNX Runtime**: AIæ¨¡å‹æ¨ç†å¼•æ“
- **LanceDB**: å‘é‡æ•°æ®åº“
- **ESBuild**: JavaScriptæ‰“åŒ…å·¥å…·
- **Ripgrep**: æ–‡æœ¬æœç´¢å·¥å…·

### 3. `package.js` - å®é™…æ‰“åŒ…è„šæœ¬

**ğŸ“¦ ä¸»è¦ä½œç”¨**: å°†å‡†å¤‡å¥½çš„æ–‡ä»¶æ‰“åŒ…æˆæœ€ç»ˆçš„zipæ–‡ä»¶

**æ ¸å¿ƒåŠŸèƒ½:**

- ğŸ” **æ–‡ä»¶éªŒè¯**: ç¡®ä¿å…³é”®æ–‡ä»¶å­˜åœ¨ï¼ˆå¦‚ `out/extension.js`ï¼‰
- ğŸ› ï¸ **è‡ªåŠ¨æ„å»º**: å¦‚æœextension.jsä¸å­˜åœ¨ï¼Œè‡ªåŠ¨è¿è¡Œesbuild
- ğŸ“ **æ–‡ä»¶é€‰æ‹©**: é€‰æ‹©æ€§åŒ…å«å¿…è¦çš„æ–‡ä»¶å’Œç›®å½•
- ğŸ—œï¸ **å‹ç¼©æ‰“åŒ…**: åˆ›å»ºzipæˆ–tar.gzæ ¼å¼çš„æ‰©å±•åŒ…
- ğŸš« **æ’é™¤è§„åˆ™**: æ’é™¤ä¸å¿…è¦çš„æ–‡ä»¶ï¼ˆå¦‚å¼€å‘ä¾èµ–ï¼‰

**åŒ…å«çš„æ–‡ä»¶/ç›®å½•:**

- `out/` - ç¼–è¯‘åçš„æ‰©å±•ä»£ç å’Œä¾èµ–
- `bin/` - åŸç”ŸäºŒè¿›åˆ¶æ–‡ä»¶
- `gui/` - ç”¨æˆ·ç•Œé¢èµ„æº
- `media/` - åª’ä½“æ–‡ä»¶å’Œæ•™ç¨‹
- `models/` - AIæ¨¡å‹æ–‡ä»¶
- `textmate-syntaxes/` - è¯­æ³•é«˜äº®æ–‡ä»¶
- `config_schema.json` - é…ç½®æ¨¡å¼
- `package.json` - åŒ…ä¿¡æ¯
- `README.md` - è¯´æ˜æ–‡æ¡£

### 4. `validate-native-deps.js` - åŸç”Ÿä¾èµ–éªŒè¯å·¥å…·

**ğŸ” ä¸»è¦ä½œç”¨**: éªŒè¯åŸç”Ÿä¾èµ–çš„å®Œæ•´æ€§å’Œæ­£ç¡®æ€§

**æ ¸å¿ƒåŠŸèƒ½:**

- ğŸ“‹ **æœ¬åœ°éªŒè¯**: æ£€æŸ¥æœ¬åœ°æ„å»ºçš„åŸç”Ÿä¾èµ–æ–‡ä»¶
- ğŸ“¦ **åŒ…éªŒè¯**: æ£€æŸ¥zipæ–‡ä»¶ä¸­çš„åŸç”Ÿæ¨¡å—
- ğŸ“Š **æŠ¥å‘Šç”Ÿæˆ**: ç”Ÿæˆè¯¦ç»†çš„ä¾èµ–æ£€æŸ¥æŠ¥å‘Š
- ğŸ¯ **å¹³å°ç‰¹å®š**: é’ˆå¯¹ä¸åŒå¹³å°éªŒè¯ç›¸åº”çš„ä¾èµ–æ–‡ä»¶

### 5. `utils.js` - å·¥å…·å‡½æ•°åº“

**ğŸ› ï¸ ä¸»è¦ä½œç”¨**: æä¾›æ‰€æœ‰è„šæœ¬å…±äº«çš„å·¥å…·å‡½æ•°

**æ ¸å¿ƒåŠŸèƒ½:**

- â¬‡ï¸ **ä¸‹è½½ç®¡ç†**: å¤„ç†åŸç”ŸäºŒè¿›åˆ¶æ–‡ä»¶çš„ä¸‹è½½å’Œæœ¬åœ°ç¼“å­˜
- ğŸ“ **æ–‡ä»¶æ“ä½œ**: å¤åˆ¶ã€ç§»åŠ¨ã€éªŒè¯æ–‡ä»¶å’Œç›®å½•
- ğŸ—ï¸ **æ„å»ºå·¥å…·**: GUIæ„å»ºã€æ¨¡å—å®‰è£…ã€èµ„æºå¤„ç†
- ğŸ”§ **å¹³å°æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹å’Œå¤„ç†ä¸åŒå¹³å°çš„å·®å¼‚
- ğŸ—ƒï¸ **ç¼“å­˜ç®¡ç†**: æ”¯æŒæœ¬åœ°ç¼“å­˜ä»¥åŠ é€Ÿæ„å»ºè¿‡ç¨‹

## ä½¿ç”¨æ–¹æ³•

### ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# 1. æ‰“åŒ…æ‰€æœ‰æ”¯æŒçš„å¹³å° (æ¨èç”¨æ³•)
npm run package-all-platforms

# 2. æ‰“åŒ…ç‰¹å®šå¹³å°
npm run package-win32-x64      # Windows x64
npm run package-win32-arm64    # Windows ARM64
npm run package-darwin-x64     # macOS x64
npm run package-darwin-arm64   # macOS ARM64

# 3. å¸¦éªŒè¯çš„æ‰“åŒ…
npm run package-all-platforms -- --validate-zip

# 4. æ¸…ç†åé‡æ–°æ‰“åŒ…
npm run package-all-platforms -- --clean
```

### ğŸ”§ é«˜çº§ç”¨æ³•

```bash
# åªå‡†å¤‡ä¾èµ–ï¼Œä¸æ‰“åŒ…
npm run prepare-deps -- --target win32-x64

# éªŒè¯ç‰¹å®šå¹³å°çš„ä¾èµ–
npm run validate-deps -- --target win32-x64

# éªŒè¯zipæ–‡ä»¶å†…å®¹
npm run validate-deps -- --zip build/continue-hbuilderx-0.1.0-win32-x64.zip

# éªŒè¯æ‰€æœ‰å¹³å°
npm run validate-deps -- --all
```

### ğŸ› å¼€å‘è°ƒè¯•ç”¨æ³•

```bash
# å¿«é€Ÿæ„å»ºï¼ˆå¼€å‘é˜¶æ®µï¼‰
npm run build

# å•ç‹¬è¿è¡Œè„šæœ¬è¿›è¡Œè°ƒè¯•
node scripts/prepackage-cross-platform.js --target win32-x64
node scripts/package.js --target win32-x64
node scripts/validate-native-deps.js --target win32-x64

# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
node scripts/package-all-platforms.js --help
```

## è„šæœ¬ä¾èµ–å…³ç³»

### è°ƒç”¨é“¾è·¯

```
package-all-platforms.js (ä¸»æ§åˆ¶å™¨)
â”œâ”€â”€ npm run prepare-deps (prepackage-cross-platform.js)
â”‚   â”œâ”€â”€ utils.js (å„ç§å·¥å…·å‡½æ•°)
â”‚   â”œâ”€â”€ ä¸‹è½½åŸç”Ÿä¾èµ–
â”‚   â”œâ”€â”€ æ„å»ºGUI
â”‚   â””â”€â”€ å¤åˆ¶èµ„æºæ–‡ä»¶
â”œâ”€â”€ validateNativeDependencies() (å†…ç½®éªŒè¯)
â”œâ”€â”€ npm run package (package.js)
â”‚   â”œâ”€â”€ éªŒè¯extension.jså­˜åœ¨
â”‚   â”œâ”€â”€ è‡ªåŠ¨è¿è¡Œesbuildï¼ˆå¦‚éœ€è¦ï¼‰
â”‚   â””â”€â”€ åˆ›å»ºzipæ–‡ä»¶
â””â”€â”€ validateZipContents() (å¯é€‰çš„zipéªŒè¯)
```

### npm scripts æ˜ å°„

```json
{
  "prepare-deps": "node scripts/prepackage-cross-platform.js",
  "package": "node scripts/package.js",
  "package-all-platforms": "node scripts/package-all-platforms.js",
  "validate-deps": "node scripts/validate-native-deps.js"
}
```

## åŸç”Ÿä¾èµ–è¯´æ˜

æ‰©å±•åŒ…å«ä»¥ä¸‹åŸç”Ÿä¾èµ–ï¼Œéœ€è¦ä¸ºæ¯ä¸ªç›®æ ‡å¹³å°ä¸‹è½½å¯¹åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š

### 1. SQLite3 (`node_sqlite3.node`)

- **ç”¨é€”:** æ•°æ®åº“å­˜å‚¨å’Œç´¢å¼•
- **ä½ç½®:** `out/build/Release/node_sqlite3.node`
- **æ¥æº:** https://github.com/TryGhost/node-sqlite3/releases/
- **ç‰ˆæœ¬:** v5.1.7

### 2. ONNX Runtime (`onnxruntime_binding.node`)

- **ç”¨é€”:** AIæ¨¡å‹æ¨ç†
- **ä½ç½®:** `bin/napi-v3/{os}/{arch}/onnxruntime_binding.node`
- **åº“æ–‡ä»¶:**
  - macOS: `libonnxruntime.1.14.0.dylib`
  - Linux: `libonnxruntime.so.1.14.0`
  - Windows: `onnxruntime.dll`

### 3. LanceDB (`index.node`)

- **ç”¨é€”:** å‘é‡æ•°æ®åº“
- **ä½ç½®:** `out/node_modules/@lancedb/vectordb-{platform}/index.node`
- **ç‰¹æ®Šè¯´æ˜:** Windows ARM64ä½¿ç”¨x64ç‰ˆæœ¬

### 4. ESBuild (`esbuild` / `esbuild.exe`)

- **ç”¨é€”:** JavaScriptæ‰“åŒ…å·¥å…·
- **ä½ç½®:** `out/node_modules/@esbuild/{platform}/bin/esbuild`

### 5. Ripgrep (`rg` / `rg.exe`)

- **ç”¨é€”:** æ–‡æœ¬æœç´¢å·¥å…·
- **ä½ç½®:** `out/node_modules/@vscode/ripgrep/bin/rg`

## å¹³å°æ”¯æŒ

| å¹³å°    | æ¶æ„  | çŠ¶æ€ | å¤‡æ³¨               |
| ------- | ----- | ---- | ------------------ |
| Windows | x64   | âœ…   | å®Œå…¨æ”¯æŒ           |
| Windows | ARM64 | âš ï¸   | LanceDBä½¿ç”¨x64ç‰ˆæœ¬ |
| macOS   | x64   | âœ…   | å®Œå…¨æ”¯æŒ           |
| macOS   | ARM64 | âœ…   | å®Œå…¨æ”¯æŒ           |

**æ³¨æ„**: æ ¹æ®é¡¹ç›®å†…å­˜è®°å½•ï¼ŒLinuxå¹³å°æ‰“åŒ…å·²ä¸å†éœ€è¦ï¼Œå› æ­¤å·²ä»æ”¯æŒåˆ—è¡¨ä¸­ç§»é™¤ã€‚

## å¸¸è§é—®é¢˜

### Q: Windowsä¸ŠæŠ¥"æ‰¾ä¸åˆ°sqlite3"é”™è¯¯

**A:** ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ç›®æ ‡å¹³å°æ‰“åŒ…ï¼š

```bash
npm run package-win32-x64  # é’ˆå¯¹Windows x64
```

### Q: å¦‚ä½•éªŒè¯æ‰“åŒ…æ˜¯å¦æ­£ç¡®ï¼Ÿ

**A:** ä½¿ç”¨éªŒè¯è„šæœ¬ï¼š

```bash
# éªŒè¯zipå†…å®¹
npm run validate-deps -- --zip build/your-package.zip

# éªŒè¯æœ¬åœ°æ„å»º
npm run validate-deps -- --target win32-x64
```

### Q: æœ¬åœ°ç¼“å­˜å¦‚ä½•ä½¿ç”¨ï¼Ÿ

**A:** è®¾ç½®ç¯å¢ƒå˜é‡æŒ‡å‘æœ¬åœ°ç¼“å­˜ç›®å½•ï¼š

```bash
export CONTINUE_SQLITE3_LOCAL_DIR="/path/to/sqlite3/cache"
export CONTINUE_RIPGREP_LOCAL_DIR="/path/to/ripgrep/cache"
```

### Q: å¦‚ä½•æ¸…ç†æ„å»ºç¼“å­˜ï¼Ÿ

**A:** ä½¿ç”¨æ¸…ç†é€‰é¡¹ï¼š

```bash
npm run package-all-platforms -- --clean
```

### Q: æ‰“åŒ…å¤±è´¥å¦‚ä½•è°ƒè¯•ï¼Ÿ

**A:** åˆ†æ­¥éª¤æ‰§è¡Œå’ŒéªŒè¯ï¼š

```bash
# 1. å•ç‹¬å‡†å¤‡ä¾èµ–
npm run prepare-deps -- --target win32-x64

# 2. éªŒè¯ä¾èµ–æ˜¯å¦æ­£ç¡®
npm run validate-deps -- --target win32-x64

# 3. æ‰§è¡Œæ‰“åŒ…
npm run package -- --target win32-x64

# 4. éªŒè¯æœ€ç»ˆåŒ…
npm run validate-deps -- --zip build/continue-hbuilderx-*.zip
```

## å¼€å‘æµç¨‹

### ğŸ”„ å®Œæ•´å¼€å‘å‘¨æœŸ

1. **å¼€å‘é˜¶æ®µ**:

   ```bash
   npm run build  # å¿«é€Ÿæ„å»ºï¼Œç”¨äºå¼€å‘æµ‹è¯•
   ```

2. **æµ‹è¯•é˜¶æ®µ**:

   ```bash
   npm run package-win32-x64  # æ‰“åŒ…æµ‹è¯•ç‰¹å®šå¹³å°
   ```

3. **å‘å¸ƒé˜¶æ®µ**:

   ```bash
   npm run package-all-platforms  # æ‰“åŒ…æ‰€æœ‰å¹³å°
   ```

4. **éªŒè¯é˜¶æ®µ**:
   ```bash
   npm run validate-deps -- --all  # éªŒè¯æ‰€æœ‰æ‰“åŒ…ç»“æœ
   ```

### ğŸ› ï¸ è„šæœ¬å¼€å‘å’Œè°ƒè¯•

```bash
# è°ƒè¯•å•ä¸ªè„šæœ¬
node scripts/prepackage-cross-platform.js --target win32-x64
node scripts/package.js --target win32-x64
node scripts/validate-native-deps.js --target win32-x64

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
DEBUG=* npm run package-all-platforms

# æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶
ls -la build/
unzip -l build/continue-hbuilderx-*.zip
```

## è¾“å‡ºæ–‡ä»¶

æ‰“åŒ…å®Œæˆåï¼Œåœ¨ `build/` ç›®å½•ä¸‹ä¼šç”Ÿæˆï¼š

### ğŸ“¦ æ‰©å±•åŒ…æ–‡ä»¶

- `continue-hbuilderx-{version}-{platform}.zip` - å„å¹³å°çš„æ‰©å±•åŒ…

### ğŸ“Š æŠ¥å‘Šæ–‡ä»¶

- `package-report-{timestamp}.json` - è¯¦ç»†çš„æ‰“åŒ…æŠ¥å‘Š
- æ¯ä¸ªåŒ…å†…åŒ…å« `out/package-info.json` - åŒ…ä¿¡æ¯æ–‡ä»¶

### ğŸ“‹ æŠ¥å‘Šå†…å®¹ç¤ºä¾‹

```json
{
  "timestamp": "2024-01-01T12:00:00.000Z",
  "duration": "15.3 minutes",
  "summary": {
    "total": 4,
    "successful": 4,
    "failed": 0
  },
  "results": [...],
  "nativeDependencies": ["sqlite3", "onnxruntime", "lancedb", "esbuild", "ripgrep"]
}
```

## ç¯å¢ƒå˜é‡

| å˜é‡å                       | ç”¨é€”                   | é»˜è®¤å€¼                            |
| ---------------------------- | ---------------------- | --------------------------------- |
| `CONTINUE_SQLITE3_LOCAL_DIR` | SQLite3æœ¬åœ°ç¼“å­˜ç›®å½•    | `/Users/legend/Downloads/sqlite3` |
| `CONTINUE_RIPGREP_LOCAL_DIR` | Ripgrepæœ¬åœ°ç¼“å­˜ç›®å½•    | æ—                                 |
| `GITHUB_ACTIONS`             | GitHub Actionsç¯å¢ƒæ ‡è¯† | æ—                                 |

## æ•…éšœæ’é™¤

### ğŸ”§ å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

1. **ä¸‹è½½å¤±è´¥**:

   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ä½¿ç”¨æœ¬åœ°ç¼“å­˜ç›®å½•
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

2. **æ–‡ä»¶ç¼ºå¤±**:

   - è¿è¡Œ `npm run validate-deps` ç¡®è®¤å…·ä½“ç¼ºå¤±çš„æ–‡ä»¶
   - é‡æ–°è¿è¡Œ `npm run prepare-deps`

3. **æƒé™é—®é¢˜**:

   - ç¡®ä¿æœ‰å†™å…¥ `build/`, `out/`, `bin/` ç›®å½•çš„æƒé™
   - åœ¨Windowsä¸Šå¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™

4. **å¹³å°ä¸åŒ¹é…**:

   - ç¡®è®¤ç›®æ ‡å¹³å°å‚æ•°æ­£ç¡®
   - æ£€æŸ¥æ˜¯å¦æ”¯æŒå½“å‰å¹³å°

5. **å†…å­˜ä¸è¶³**:
   - å…³é—­å…¶ä»–åº”ç”¨ç¨‹åº
   - å•ç‹¬æ‰“åŒ…æ¯ä¸ªå¹³å°è€Œä¸æ˜¯å…¨éƒ¨ä¸€èµ·

### ğŸ› è°ƒè¯•æŠ€å·§

```bash
# 1. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
npm run package-all-platforms 2>&1 | tee build.log

# 2. æ£€æŸ¥ä¸­é—´æ–‡ä»¶
ls -la out/
ls -la bin/

# 3. éªŒè¯ç‰¹å®šä¾èµ–
file out/build/Release/node_sqlite3.node
ldd out/build/Release/node_sqlite3.node  # Linux
otool -L out/build/Release/node_sqlite3.node  # macOS

# 4. æ£€æŸ¥zipå†…å®¹
unzip -l build/continue-hbuilderx-*.zip | grep -E "(sqlite3|onnx|lance|esbuild|rg)"
```

## æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•

1. **ä½¿ç”¨npm scripts**: ä¼˜å…ˆä½¿ç”¨ `npm run package-all-platforms` è€Œä¸æ˜¯ç›´æ¥è°ƒç”¨è„šæœ¬
2. **éªŒè¯æ„å»º**: æ¯æ¬¡æ‰“åŒ…åè¿è¡ŒéªŒè¯è„šæœ¬
3. **ä½¿ç”¨æœ¬åœ°ç¼“å­˜**: è®¾ç½®æœ¬åœ°ç¼“å­˜ç›®å½•ä»¥åŠ é€Ÿé‡å¤æ„å»º
4. **åˆ†æ­¥è°ƒè¯•**: é‡åˆ°é—®é¢˜æ—¶åˆ†æ­¥æ‰§è¡Œå’ŒéªŒè¯

### âŒ é¿å…çš„åšæ³•

1. **ä¸è¦æ‰‹åŠ¨ä¿®æ”¹**: ä¸è¦æ‰‹åŠ¨ä¿®æ”¹ `out/` æˆ– `bin/` ç›®å½•
2. **ä¸è¦è·³è¿‡éªŒè¯**: ä¸è¦è·³è¿‡åŸç”Ÿä¾èµ–éªŒè¯æ­¥éª¤
3. **ä¸è¦æ··ç”¨è„šæœ¬**: ä¸è¦åŒæ—¶è¿è¡Œå¤šä¸ªæ‰“åŒ…è„šæœ¬
4. **ä¸è¦å¿½ç•¥é”™è¯¯**: åŠæ—¶å¤„ç†æ„å»ºè¿‡ç¨‹ä¸­çš„è­¦å‘Šå’Œé”™è¯¯

## è„šæœ¬é—´çš„æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥ (target platform)
         â†“
package-all-platforms.js (è§£æå‚æ•°ï¼Œå¾ªç¯å¤„ç†å¹³å°)
         â†“
prepackage-cross-platform.js (å‡†å¤‡ä¾èµ–ï¼Œä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶)
         â†“
validateNativeDependencies() (éªŒè¯ä¾èµ–å®Œæ•´æ€§)
         â†“
package.js (æ‰“åŒ…æˆzipæ–‡ä»¶)
         â†“
validateZipContents() (å¯é€‰ï¼šéªŒè¯zipå†…å®¹)
         â†“
ç”ŸæˆæŠ¥å‘Šå’Œç»Ÿè®¡ä¿¡æ¯
```

é€šè¿‡è¿™ä¸ªå®Œæ•´çš„è„šæœ¬ç³»ç»Ÿï¼Œå¯ä»¥ç¡®ä¿HBuilderXæ‰©å±•åœ¨æ‰€æœ‰æ”¯æŒçš„å¹³å°ä¸Šéƒ½èƒ½æ­£ç¡®è¿è¡Œï¼ŒåŒæ—¶æä¾›äº†å®Œå–„çš„éªŒè¯å’Œé”™è¯¯å¤„ç†æœºåˆ¶ã€‚
